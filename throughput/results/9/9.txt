BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  264035381.72603
 ALGERIA                   |   1997 | 456548663.005331
 ALGERIA                   |   1996 | 461813333.052257
 ALGERIA                   |   1995 |   465561821.6568
 ALGERIA                   |   1994 | 453806878.319109
 ALGERIA                   |   1993 | 460389442.410323
 ALGERIA                   |   1992 | 458362494.299481
 ARGENTINA                 |   1998 | 271584446.529349
 ARGENTINA                 |   1997 | 467533427.641455
 ARGENTINA                 |   1996 | 472436470.211863
 ARGENTINA                 |   1995 | 471604643.575441
 ARGENTINA                 |   1994 | 466661981.272552
 ARGENTINA                 |   1993 | 462954578.738988
 ARGENTINA                 |   1992 |  465810473.74221
 BRAZIL                    |   1998 | 276047428.181977
 BRAZIL                    |   1997 | 474167389.069789
 BRAZIL                    |   1996 | 472461234.492796
 BRAZIL                    |   1995 | 471284856.535256
 BRAZIL                    |   1994 |  468434251.47393
 BRAZIL                    |   1993 | 473599739.522307
 BRAZIL                    |   1992 | 466827430.301615
 CANADA                    |   1998 | 273592624.595786
 CANADA                    |   1997 | 477789458.426388
 CANADA                    |   1996 | 479854489.094056
 CANADA                    |   1995 | 473895080.052684
 CANADA                    |   1994 | 476567442.413094
 CANADA                    |   1993 | 476371708.888065
 CANADA                    |   1992 | 476171913.825849
 CHINA                     |   1998 | 269572006.526266
 CHINA                     |   1997 | 466107045.816242
 CHINA                     |   1996 | 460095932.717333
 CHINA                     |   1995 | 462021146.017551
 CHINA                     |   1994 | 463316266.740365
 CHINA                     |   1993 | 461882788.506355
 CHINA                     |   1992 | 465196983.512738
 EGYPT                     |   1998 | 271210691.659523
 EGYPT                     |   1997 | 459268398.201061
 EGYPT                     |   1996 | 461713205.627716
 EGYPT                     |   1995 | 455365634.325129
 EGYPT                     |   1994 | 456269674.776675
 EGYPT                     |   1993 | 470387700.198246
 EGYPT                     |   1992 | 459655783.499469
 ETHIOPIA                  |   1998 | 268164586.454946
 ETHIOPIA                  |   1997 | 444758653.610022
 ETHIOPIA                  |   1996 | 457804212.510544
 ETHIOPIA                  |   1995 | 462328809.089414
 ETHIOPIA                  |   1994 | 463991280.381497
 ETHIOPIA                  |   1993 | 450409527.043865
 ETHIOPIA                  |   1992 | 457916617.576768
 FRANCE                    |   1998 | 265800493.165117
 FRANCE                    |   1997 | 462614527.491642
 FRANCE                    |   1996 | 462397443.160277
 FRANCE                    |   1995 |  461661708.49241
 FRANCE                    |   1994 | 469534724.076772
 FRANCE                    |   1993 | 462041777.118675
 FRANCE                    |   1992 | 466787620.658361
 GERMANY                   |   1998 |  277586718.47514
 GERMANY                   |   1997 | 481648329.189351
 GERMANY                   |   1996 | 482451967.997737
 GERMANY                   |   1995 | 474435003.482585
 GERMANY                   |   1994 | 471894670.613132
 GERMANY                   |   1993 | 472804176.826287
 GERMANY                   |   1992 | 476460451.478513
 INDIA                     |   1998 | 279322271.424071
 INDIA                     |   1997 | 473324386.723406
 INDIA                     |   1996 | 474983144.333218
 INDIA                     |   1995 | 475223734.039676
 INDIA                     |   1994 | 474637995.683425
 INDIA                     |   1993 |  471948172.01937
 INDIA                     |   1992 | 483909537.227135
 INDONESIA                 |   1998 | 271214277.602142
 INDONESIA                 |   1997 | 458368496.039839
 INDONESIA                 |   1996 | 468746782.020331
 INDONESIA                 |   1995 | 453052404.288197
 INDONESIA                 |   1994 | 459206513.074575
 INDONESIA                 |   1993 | 458186620.957679
 INDONESIA                 |   1992 | 458889688.412518
 IRAN                      |   1998 | 266178212.070298
 IRAN                      |   1997 | 456132338.504215
 IRAN                      |   1996 | 462242323.905409
 IRAN                      |   1995 | 452858815.989723
 IRAN                      |   1994 | 457166528.056359
 IRAN                      |   1993 | 460224690.322612
 IRAN                      |   1992 | 461530787.740996
 IRAQ                      |   1998 |  272093477.29669
 IRAQ                      |   1997 | 465634691.548984
 IRAQ                      |   1996 | 469337661.714934
 IRAQ                      |   1995 | 464875987.470006
 IRAQ                      |   1994 |  475956307.85996
 IRAQ                      |   1993 | 466313640.153521
 IRAQ                      |   1992 | 467262256.165501
 JAPAN                     |   1998 | 270937198.612363
 JAPAN                     |   1997 | 460254560.079994
 JAPAN                     |   1996 | 459980675.096997
 JAPAN                     |   1995 | 467386148.842187
 JAPAN                     |   1994 |  459942410.84938
 JAPAN                     |   1993 | 463695409.331907
 JAPAN                     |   1992 | 464886935.628196
 JORDAN                    |   1998 | 273998822.317484
 JORDAN                    |   1997 | 456064618.021987
 JORDAN                    |   1996 | 459886717.483154
 JORDAN                    |   1995 | 460684999.354378
 JORDAN                    |   1994 | 459996228.110208
 JORDAN                    |   1993 | 458217319.118553
 JORDAN                    |   1992 | 450906561.068927
 KENYA                     |   1998 | 280302933.571595
 KENYA                     |   1997 | 474160028.794896
 KENYA                     |   1996 | 481942897.418549
 KENYA                     |   1995 | 469244109.843553
 KENYA                     |   1994 | 484930680.890456
 KENYA                     |   1993 | 469952912.268633
 KENYA                     |   1992 | 473315939.989956
 MOROCCO                   |   1998 | 270562713.237939
 MOROCCO                   |   1997 | 446724592.576936
 MOROCCO                   |   1996 | 457175296.809909
 MOROCCO                   |   1995 | 468449243.689038
 MOROCCO                   |   1994 | 459465519.995603
 MOROCCO                   |   1993 | 456422581.569767
 MOROCCO                   |   1992 | 462584789.621641
 MOZAMBIQUE                |   1998 | 274254646.632394
 MOZAMBIQUE                |   1997 | 459634678.430228
 MOZAMBIQUE                |   1996 | 468870109.001159
 MOZAMBIQUE                |   1995 | 464039962.942056
 MOZAMBIQUE                |   1994 | 465513799.377831
 MOZAMBIQUE                |   1993 |  470947534.20077
 MOZAMBIQUE                |   1992 | 462807430.066386
 PERU                      |   1998 | 273084925.204541
 PERU                      |   1997 | 472810523.956761
 PERU                      |   1996 | 469749798.997909
 PERU                      |   1995 | 467003958.121526
 PERU                      |   1994 | 471368152.831642
 PERU                      |   1993 | 464116300.789906
 PERU                      |   1992 | 466623407.951349
 ROMANIA                   |   1998 | 276567758.661408
 ROMANIA                   |   1997 | 465080803.178161
 ROMANIA                   |   1996 | 472047026.696176
 ROMANIA                   |   1995 | 470028446.362208
 ROMANIA                   |   1994 | 468355302.842726
 ROMANIA                   |   1993 | 475562740.668103
 ROMANIA                   |   1992 |  470000481.46287
 RUSSIA                    |   1998 | 273148805.155211
 RUSSIA                    |   1997 | 460777737.789446
 RUSSIA                    |   1996 | 470901497.998213
 RUSSIA                    |   1995 | 461261421.713525
 RUSSIA                    |   1994 | 460783291.683807
 RUSSIA                    |   1993 |  468870880.57723
 RUSSIA                    |   1992 | 460113291.349737
 SAUDI ARABIA              |   1998 | 269778716.701825
 SAUDI ARABIA              |   1997 | 474776202.697285
 SAUDI ARABIA              |   1996 | 465625878.103436
 SAUDI ARABIA              |   1995 | 470947416.141261
 SAUDI ARABIA              |   1994 | 466895932.318366
 SAUDI ARABIA              |   1993 | 473431170.528482
 SAUDI ARABIA              |   1992 | 473952477.292175
 UNITED KINGDOM            |   1998 | 265889286.334681
 UNITED KINGDOM            |   1997 | 460611178.855974
 UNITED KINGDOM            |   1996 | 448788896.831834
 UNITED KINGDOM            |   1995 | 458063773.191456
 UNITED KINGDOM            |   1994 |  453602144.23817
 UNITED KINGDOM            |   1993 | 455715769.752936
 UNITED KINGDOM            |   1992 |  456911269.55289
 UNITED STATES             |   1998 | 283832122.370788
 UNITED STATES             |   1997 | 481580855.804313
 UNITED STATES             |   1996 | 475293156.489618
 UNITED STATES             |   1995 | 472583061.152685
 UNITED STATES             |   1994 | 482548583.040748
 UNITED STATES             |   1993 | 476343151.740031
 UNITED STATES             |   1992 | 471684477.112204
 VIETNAM                   |   1998 | 278018071.427575
 VIETNAM                   |   1997 | 465098614.342167
 VIETNAM                   |   1996 | 466169606.964059
 VIETNAM                   |   1995 | 466603173.454076
 VIETNAM                   |   1994 | 470444597.921757
 VIETNAM                   |   1993 |  466689879.13231
 VIETNAM                   |   1992 |  468642346.94292
(175 rows)

COMMIT;
COMMIT
